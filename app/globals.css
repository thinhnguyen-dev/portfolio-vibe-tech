@import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&display=swap');
@import "tailwindcss";
@import "katex/dist/katex.min.css";
@import "react-toastify/dist/ReactToastify.css";

/* Dark theme (default) */
:root,
:root.dark {
  --background: #282C33;
  --foreground: #FFFFFF;
  --accent: #C778DD;
  --text-secondary: #ABB2BF;
  --article-bg: #25282d;
  --code-bg: #1e2126;
  --border-color: rgba(171, 178, 191, 0.1);
  --placeholder-bg: #374151;
}

/* Light theme */
:root.light {
  --background: #FFFFFF;
  --foreground: #282C33;
  --accent: #C778DD;
  --text-secondary: #6B7280;
  --article-bg: #F9FAFB;
  --code-bg: #F3F4F6;
  --border-color: rgba(107, 114, 128, 0.2);
  --placeholder-bg: #E5E7EB;
}

@theme {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-accent: var(--accent);
  --color-text-secondary: var(--text-secondary);
  --color-article-bg: var(--article-bg);
  --color-code-bg: var(--code-bg);
  --color-border: var(--border-color);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --font-fira-code: 'Fira Code', monospace;
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: var(--font-fira-code), 'Fira Code', monospace;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Apply Fira Code to all code elements for consistency */
code,
pre,
kbd,
samp {
  font-family: var(--font-fira-code), 'Fira Code', monospace;
  font-variant-ligatures: common-ligatures;
}

/* Ensure article width remains fixed - constrain all child elements */
.markdown-content {
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
}

/* Constrain images */
.markdown-content img {
  max-width: 100%;
  height: auto;
  display: block;
}

/* Constrain code blocks and pre elements */
.markdown-content pre,
.markdown-content .code-block-wrapper {
  max-width: 100%;
  overflow-x: auto;
  box-sizing: border-box;
}

/* Constrain tables */
.markdown-content table {
  max-width: 100%;
  width: 100%;
  table-layout: auto;
  box-sizing: border-box;
}

/* Constrain iframes and videos */
.markdown-content iframe,
.markdown-content video {
  max-width: 100%;
  width: 100%;
  box-sizing: border-box;
}

/* Constrain any other block-level elements */
.markdown-content > * {
  max-width: 100%;
  box-sizing: border-box;
}

/* Remove bottom margin from paragraphs inside blockquotes */
.markdown-content blockquote p {
  margin-bottom: 0 !important;
}

/* Add small spacing between multiple paragraphs in blockquotes */
.markdown-content blockquote p:not(:last-child) {
  margin-bottom: 0.5rem;
}

/* Ensure anchor tags inside paragraphs are inline and don't take full width */
.markdown-content p a {
  display: inline;
}

/* Make multiple images display inline with wrapping */
.markdown-content p:has(.inline-image + .inline-image),
.markdown-content p:has(.inline-image:not(:only-child)) {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  align-items: flex-start;
  margin-bottom: 1rem;
}

/* Single image in paragraph - keep block display */
.markdown-content p:has(.inline-image:only-child) {
  display: block;
}

.markdown-content .inline-image {
  display: inline-block;
  flex-shrink: 0;
  max-width: 100%;
  height: auto;
  margin: 0;
  vertical-align: middle;
}

/* When multiple images, remove individual margins */
.markdown-content p:has(.inline-image + .inline-image) .inline-image,
.markdown-content p:has(.inline-image:not(:only-child)) .inline-image {
  margin: 0;
}

/* Task list (checkbox list) styling */
.markdown-content ul.contains-task-list {
  list-style: none;
  padding-left: 0;
}

.markdown-content ul.contains-task-list li.task-list-item {
  margin-left: 0;
  list-style: none;
}

/* Checkbox styling for task lists */
.markdown-content input.task-list-item-checkbox,
.markdown-content input[type="checkbox"] {
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  width: 1.25rem;
  height: 1.25rem;
  border: 2px solid var(--text-secondary);
  border-radius: 0.25rem;
  background-color: var(--article-bg);
  cursor: pointer;
  position: relative;
  flex-shrink: 0;
  margin-top: 0.125rem;
  transition: all 0.2s ease;
}

.markdown-content input[type="checkbox"]:hover {
  border-color: var(--accent);
  background-color: var(--code-bg);
}

.markdown-content input[type="checkbox"]:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(199, 120, 221, 0.2);
}

.markdown-content input[type="checkbox"]:checked {
  background-color: var(--accent);
  border-color: var(--accent);
}

.markdown-content input[type="checkbox"]:checked::after {
  content: '';
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%) rotate(45deg);
  width: 0.375rem;
  height: 0.625rem;
  border: solid white;
  border-width: 0 2px 2px 0;
}

.markdown-content input[type="checkbox"]:checked:hover {
  background-color: var(--accent);
  opacity: 0.9;
}

/* Decorative underline for h1 and h2 headings */
.markdown-content .heading-underline {
  padding-bottom: 0.4rem;
  border-bottom: 0.5px solid var(--accent);
  transition: border-color 0.3s ease;
}

/* Footnote styling */
.markdown-content .footnote-ref {
  vertical-align: super;
  font-size: 0.75em;
  line-height: 0;
}

.markdown-content .footnote-ref a {
  text-decoration: none;
  color: var(--accent);
  font-weight: 600;
  padding: 0 0.125rem;
  border-radius: 0.125rem;
  transition: background-color 0.2s ease;
}

.markdown-content .footnote-ref a:hover {
  background-color: var(--code-bg);
  text-decoration: underline;
}

.markdown-content .footnotes {
  margin-top: 2rem;
  padding-top: 1.5rem;
  border-top: 1px solid var(--border-color);
}

.markdown-content .footnote-def {
  margin-left: 0 !important;
  margin-bottom: 0.5rem;
  color: var(--text-secondary);
  font-size: 0.875rem;
  line-height: 1.5;
  list-style: none;
}

.markdown-content .footnote-def p {
  margin: 0 !important;
  display: inline;
  position: relative;
}

.markdown-content .footnote-def p::marker,
.markdown-content .footnote-def p::before {
  content: attr(data-footnote-number);
  font-weight: 600;
  color: var(--accent);
  margin-right: 0.5rem;
}

/* Ensure footnote lists don't show numbers */
.markdown-content .footnotes-list {
  list-style: none !important;
  padding-left: 0 !important;
}

.markdown-content .footnotes-list li {
  margin-left: 0 !important;
}

.markdown-content .footnote-def a,
.markdown-content .footnote-def p a {
  color: var(--accent);
  text-decoration: none;
}

.markdown-content .footnote-def a:hover,
.markdown-content .footnote-def p a:hover {
  text-decoration: underline;
}

.markdown-content .footnotes-list {
  list-style: none;
  padding-left: 0;
  margin-left: 0;
}

/* KaTeX theme-aware styles */
.katex {
  color: var(--foreground);
}

.katex .base {
  color: var(--foreground);
}

.katex .mord {
  color: var(--foreground);
}

.katex .mrel {
  color: var(--foreground);
}

.katex .mop {
  color: var(--foreground);
}

.katex .mbin {
  color: var(--foreground);
}

.katex .mopen {
  color: var(--foreground);
}

.katex .mclose {
  color: var(--foreground);
}

.katex .mpunct {
  color: var(--foreground);
}

.katex .mord.mathnormal {
  color: var(--foreground);
}

.katex .accent {
  color: var(--accent);
}

.katex .munderover {
  color: var(--foreground);
}

.katex .mtable {
  color: var(--foreground);
}

.katex .mfrac {
  color: var(--foreground);
}

.katex .sqrt {
  color: var(--foreground);
}

.katex .overline {
  border-top-color: var(--foreground);
}

.katex .underline {
  border-bottom-color: var(--foreground);
}

.katex .boxpad {
  padding: 0;
}

.katex-block {
  display: block;
  margin: 1rem 0;
  text-align: center;
  overflow-x: auto;
  overflow-y: hidden;
}

.katex-inline {
  display: inline-block;
  vertical-align: baseline;
}

/* Ensure KaTeX renders properly in both themes */
:root.dark .katex,
:root.dark .katex * {
  color: var(--foreground) !important;
}

:root.light .katex,
:root.light .katex * {
  color: var(--foreground) !important;
}

/* Shimmer animation for loading progress bars */
@keyframes shimmer {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}

/* Toast Notification Styles - Theme-aware */
.Toastify__toast-container {
  font-family: var(--font-fira-code), 'Fira Code', monospace;
}

.Toastify__toast {
  background: var(--article-bg) !important;
  color: var(--foreground) !important;
  border: 1px solid var(--border-color) !important;
  border-radius: 0.5rem !important;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;
  padding: 1rem !important;
  min-height: auto !important;
}

.Toastify__toast-body {
  color: var(--foreground) !important;
  font-family: var(--font-fira-code), 'Fira Code', monospace !important;
  padding: 0 !important;
  margin: 0 !important;
}

.Toastify__toast--success {
  background: var(--article-bg) !important;
  border-left: 4px solid #10b981 !important;
}

.Toastify__toast--error {
  background: var(--article-bg) !important;
  border-left: 4px solid #ef4444 !important;
}

.Toastify__toast--info {
  background: var(--article-bg) !important;
  border-left: 4px solid var(--accent) !important;
}

.Toastify__toast--warning {
  background: var(--article-bg) !important;
  border-left: 4px solid #f59e0b !important;
}

.Toastify__progress-bar {
  background: var(--accent) !important;
}

.Toastify__progress-bar--success {
  background: #10b981 !important;
}

.Toastify__progress-bar--error {
  background: #ef4444 !important;
}

.Toastify__progress-bar--info {
  background: var(--accent) !important;
}

.Toastify__progress-bar--warning {
  background: #f59e0b !important;
}

.Toastify__close-button {
  color: var(--text-secondary) !important;
  opacity: 0.7 !important;
}

.Toastify__close-button:hover {
  opacity: 1 !important;
  color: var(--foreground) !important;
}

/* Dark theme specific adjustments */
:root.dark .Toastify__toast {
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2) !important;
}

/* Light theme specific adjustments */
:root.light .Toastify__toast {
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;
}

/* Code Block Styles - Theme-aware */
.code-block-wrapper {
  background: var(--code-bg) !important;
}

.code-block-wrapper pre {
  background: transparent !important;
  margin: 0 !important;
}

/* Override syntax highlighter colors to match design system */
.code-block-wrapper code {
  color: var(--foreground) !important;
  background: transparent !important;
}

/* Dark theme syntax highlighting adjustments */
:root.dark .code-block-wrapper .token.comment,
:root.dark .code-block-wrapper .token.prolog,
:root.dark .code-block-wrapper .token.doctype,
:root.dark .code-block-wrapper .token.cdata {
  color: var(--text-secondary) !important;
  opacity: 0.7;
}

:root.dark .code-block-wrapper .token.keyword,
:root.dark .code-block-wrapper .token.operator {
  color: var(--accent) !important;
}

:root.dark .code-block-wrapper .token.string,
:root.dark .code-block-wrapper .token.char {
  color: #98c379 !important;
}

:root.dark .code-block-wrapper .token.number {
  color: #d19a66 !important;
}

:root.dark .code-block-wrapper .token.function {
  color: #61afef !important;
}

:root.dark .code-block-wrapper .token.variable {
  color: #e06c75 !important;
}

:root.dark .code-block-wrapper .token.property {
  color: #e5c07b !important;
}

/* Light theme syntax highlighting adjustments */
:root.light .code-block-wrapper .token.comment,
:root.light .code-block-wrapper .token.prolog,
:root.light .code-block-wrapper .token.doctype,
:root.light .code-block-wrapper .token.cdata {
  color: var(--text-secondary) !important;
  opacity: 0.7;
}

:root.light .code-block-wrapper .token.keyword,
:root.light .code-block-wrapper .token.operator {
  color: var(--accent) !important;
}

:root.light .code-block-wrapper .token.string,
:root.light .code-block-wrapper .token.char {
  color: #0d7377 !important;
}

:root.light .code-block-wrapper .token.number {
  color: #b8860b !important;
}

:root.light .code-block-wrapper .token.function {
  color: #0066cc !important;
}

:root.light .code-block-wrapper .token.variable {
  color: #cc0000 !important;
}

:root.light .code-block-wrapper .token.property {
  color: #8b6914 !important;
}

/* Ensure syntax highlighter respects theme variables */
.code-block-wrapper pre[class*="language-"] {
  background: transparent !important;
  color: var(--foreground) !important;
}

.code-block-wrapper code[class*="language-"] {
  background: transparent !important;
  color: var(--foreground) !important;
}

/* Custom Scrollbar Styling for Table of Contents */
.toc-container {
  scrollbar-width: thin;
  scrollbar-color: var(--border-color) transparent;
}

.toc-container::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

.toc-container::-webkit-scrollbar-track {
  background: transparent;
  border-radius: 4px;
}

.toc-container::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 4px;
  transition: background-color 0.2s ease;
}

.toc-container::-webkit-scrollbar-thumb:hover {
  background: var(--accent);
  opacity: 0.7;
}

/* Dark theme scrollbar adjustments */
:root.dark .toc-container::-webkit-scrollbar-thumb {
  background: rgba(171, 178, 191, 0.3);
}

:root.dark .toc-container::-webkit-scrollbar-thumb:hover {
  background: var(--accent);
  opacity: 0.8;
}

/* Light theme scrollbar adjustments */
:root.light .toc-container::-webkit-scrollbar-thumb {
  background: rgba(107, 114, 128, 0.3);
}

:root.light .toc-container::-webkit-scrollbar-thumb:hover {
  background: var(--accent);
  opacity: 0.7;
}

/* Heading Glow Effect on Hover */
.heading-glow {
  transition: text-shadow 0.3s ease, filter 0.3s ease;
  cursor: pointer;
}

.heading-glow:hover {
  text-shadow: 
    0 0 10px rgba(199, 120, 221, 0.4),
    0 0 20px rgba(199, 120, 221, 0.3),
    0 0 30px rgba(199, 120, 221, 0.2);
  filter: brightness(1.1);
}

.heading-glow:hover span {
  text-shadow: 
    0 0 8px rgba(199, 120, 221, 0.6),
    0 0 16px rgba(199, 120, 221, 0.4),
    0 0 24px rgba(199, 120, 221, 0.3);
  filter: brightness(1.15);
}

/* Dark theme adjustments */
:root.dark .heading-glow:hover {
  text-shadow: 
    0 0 12px rgba(199, 120, 221, 0.5),
    0 0 24px rgba(199, 120, 221, 0.35),
    0 0 36px rgba(199, 120, 221, 0.25);
}

:root.dark .heading-glow:hover span {
  text-shadow: 
    0 0 10px rgba(199, 120, 221, 0.7),
    0 0 20px rgba(199, 120, 221, 0.5),
    0 0 30px rgba(199, 120, 221, 0.4);
}

/* Light theme adjustments */
:root.light .heading-glow:hover {
  text-shadow: 
    0 0 8px rgba(199, 120, 221, 0.35),
    0 0 16px rgba(199, 120, 221, 0.25),
    0 0 24px rgba(199, 120, 221, 0.15);
}

:root.light .heading-glow:hover span {
  text-shadow: 
    0 0 6px rgba(199, 120, 221, 0.5),
    0 0 12px rgba(199, 120, 221, 0.35),
    0 0 18px rgba(199, 120, 221, 0.25);
}
